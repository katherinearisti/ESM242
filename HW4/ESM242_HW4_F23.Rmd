---
title: "HW 4"
author: "Kat Aristi"
date: "2023-11-8"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(tidyverse)
library(nloptr)
library(knitr)
```


## Exhaustible Resource Extraction {.tabset}


Suppose there is an exhaustible resource that is costlessly extracted.  The inverse demand curve for the resource is  $p_t=a-bq_t$ where $q_t$ is the quantity extracted in time t and a=40, b=1.  The discount rate is $\delta=0.05$  and the initial stock of reserves is $R_0$ = 778.1259 units.  Set up a program to find the competitive market equilibrium and show the equilibrium values of $p_t$, $q_t$, $R_t$, and  $\pi_t$ in a table.  $R_t$ is the reserves remaining in year t and $\pi_t$ is the discounted profits in each year (without costs, they are just equal to $\rho^tp_tq_t$ ). [Hint: it is easiest to start with the price in the last period and work backwards through time.]

### A. 

List the values of $t$, $p_t$, $q_t$, $R_t$, and  $\pi_t$ in a table below.  What should be the final (year T) values of $p_T$ and $R_T$? Why?  Does the resource get more scarce over time?  What is your evidence?

<span style="color: blue;">**Solution**</span>

```{r}
exhaust <- function( T, a, b, c, delta, R0){
  
  t=seq(0,T)
  
  price <- vector(mode="numeric", length = length(t))
  quantity <- vector(mode="numeric", length = length(t))
  reserves <- vector(mode="numeric", length = length(t))
  profits <- vector(mode="numeric", length = length(t))
  
  price[T+1] = a
  reserves[1] = R0
  
  for(i in (T + 1):2){
    
    quantity[i] = (a-price[i])/b 
    price[i-1] = (price[i] + c*delta)/(1+delta)
  
  }
    
  quantity[1] = (a-price[1])/b
  profits[1] = price[1] * quantity[1]
  
  for(i in 2:(T+1)){
    
    reserves[i] = reserves[i-1] - quantity[i-1] 
    profits[i] = 1/(1+delta) * price[i] * quantity[i]
    
  }
  
  return(data.frame("Time" = t, "Price"=price, "Quantity"=quantity, "Reserves" = reserves, "Profits" = profits)) 
  
}

table1a <- exhaust(T= 36, a= 40, b= 1, delta = 0.05, R0= 778.1259, c=0)
kable(table1a)
```




### B.

Now consider extensions of the model in A.  First, assume there is a constant marginal cost of extraction c = 3.178025.  The discount profits in each year are now $\pi_t=\rho^t (p_t-c)q_t$.  Second, assume marginal costs are zero again but the initial stock of reserves increases to $R_0$ = 948.2253 units.  Third, assume marginal costs are still zero and reserves go back to $R_0$=778.1259, but the demand curve parameters are now $a$=40, $b$=0.75194.  A lower value of $b$ means that the demand curve rotates outward around $a$=40. 

List the values of $t$, $p_t$, $q_t$, $R_t$, and  $\pi_t$ for the three cases. 


<span style="color: blue;">**See tables below!**</span>

<span style="color: blue;">

</span>

Case 1:
```{r}
exhaust_case1 <- function( T, a, b, c, delta, R0){
  
  t=seq(0,T)
  
  price <- vector(mode="numeric", length = length(t))
  quantity <- vector(mode="numeric", length = length(t))
  reserves <- vector(mode="numeric", length = length(t))
  profits <- vector(mode="numeric", length = length(t))
  
  price[T+1] = a
  reserves[1] = R0
  
  for(i in (T + 1):2){
    
    quantity[i] = (a-price[i])/b 
    price[i-1] = (price[i] + c*delta)/(1+delta)
  }
    
  quantity[1] = (a-price[1])/b
  profits[1] =  delta^t * (price[1] - c) * quantity[1]
  
  for(i in 2:(T+1)){
    
    reserves[i] = reserves[i-1] - quantity[i-1] 
    profits[i] = delta^t * price[i] * quantity[i]
    
  }
  
  return(data.frame("Time" = t, "Price"=price, "Quantity"=quantity, "Reserves" = reserves, "Profits" = profits)) 
  
}

table1b_case1 <- exhaust_case1(T= 38, a= 40, b= 1, delta = 0.05, R0= 778.1259, c=3.178025)
kable(table1b_case1)
```
Case 2: 
```{r}
table1b_case2 <- exhaust_case1(T= 41, a= 40, b= 1, delta = 0.05, R0= 948.2253, c=0)
kable(table1b_case2)
```
Case 3: 
```{r}
table1b_case3 <- exhaust_case1(T= 30, a= 40, b= 0.75194, delta = 0.05, R0= 778.1259, c=0)
kable(table1b_case3)
```


### C.


What is the final year $T$ for the three cases? Explain why they are different from part A.

<span style="color: blue;">**The final T for Case One is T=38, Case Two T=41, and Case Three T=30. They are different from part A due to the change in parameters. Beginning with the change of cost in Case 1 from 0 to 3.178025. This increase in cost caused time to increase slightly from 36 to 38. This increase in cost caused both profits and prices to increase and reserves to reach 0 at a slower rate than seen in part A. When costs are higher there is an incentive to push costs off to the future and increase the time it takes for reserves to reach 0, therefore having a longer T in order to reach the price which was used to maintain the initial reserve size. In Case 2, T increases to 41 due to an increase in the amount of reserves, therefore it takes longer to reach 0 reserves. In Case 3, T decreases to 30 due to b decreasing to 0.75194. When the demand is decreased, initial price increases, so in order to ensure that you maintain the same amount of reserves your T curve (the northeast quadrant) has to become steeper. **</span>


<span style="color: blue;">

</span>

```{r}
cases <- 1:3
T <- c(38, 41, 30)
one_c <- data.frame('Cases' = cases, 'Time' = T)
kable(one_c)
```

### D. 

Compare the path of prices in the three cases to that in part A. Explain the differences.

<span style="color: blue;">**Prices in Case 1 are at a higher value than in part A. This is due to cost now being incorporated into the price **</span>

<span style="color: blue;">

</span>

```{r}
plot(table1b_case1$Quantity, table1b_case1$Price)
plot(table1b_case2$Quantity, table1b_case2$Price)
plot(table1b_case3$Quantity, table1b_case3$Price)

plot(table1a$Quantity, table1a$Price)
```


### E.

What happens to the present discounted value of profits (in other words, the value of the reserves $R_0$) in the three cases compared to part A? Explain the differences.

<span style="color: blue;">**Across all cases, the profits are increasing, especially when compared to part A. PVNB for Case 1 and 2 are the slightly larger than part A due to the time spans being longer, which allows for a longer amount of time for the profits to increase. Case 3 is the largest because the initial price is the largest, thereofre causing profits to increase.**</span>


<span style="color: blue;">

</span>



